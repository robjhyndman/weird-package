<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Surprisal probabilities — surprisal_prob • weird</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Surprisal probabilities — surprisal_prob"><meta name="description" content="Compute the probability of a surprisal at least as extreme as those observed.
A surprisal is given by \(-\log(f)\) where \(f\) is the density or
probability mass function of the distribution.
The surprisal values are computed from the distribution provided. If no
distribution is provided, a kernel density estimate is used."><meta property="og:description" content="Compute the probability of a surprisal at least as extreme as those observed.
A surprisal is given by \(-\log(f)\) where \(f\) is the density or
probability mass function of the distribution.
The surprisal values are computed from the distribution provided. If no
distribution is provided, a kernel density estimate is used."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">weird</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/robjhyndman/weird-package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Surprisal probabilities</h1>
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/weird-package/blob/main/R/surprisal_prob.R" class="external-link"><code>R/surprisal_prob.R</code></a></small>
      <div class="d-none name"><code>surprisal_prob.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the probability of a surprisal at least as extreme as those observed.
A surprisal is given by \(-\log(f)\) where \(f\) is the density or
probability mass function of the distribution.
The surprisal values are computed from the <code>distribution</code> provided. If no
distribution is provided, a kernel density estimate is used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">surprisal_prob</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  distribution <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  loo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  GPD <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  threshold_probability <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A model or numerical data set.</p></dd>


<dt id="arg-distribution">distribution<a class="anchor" aria-label="anchor" href="#arg-distribution"></a></dt>
<dd><p>A probability distribution stored as a distributional
object. Ignored if <code>object</code> is a model.</p></dd>


<dt id="arg-loo">loo<a class="anchor" aria-label="anchor" href="#arg-loo"></a></dt>
<dd><p>Logical value specifying if leave-one-out surprisals should be computed.</p></dd>


<dt id="arg-gpd">GPD<a class="anchor" aria-label="anchor" href="#arg-gpd"></a></dt>
<dd><p>Logical value specifying if a Generalized Pareto distribution
should be used to estimate the probabilities.</p></dd>


<dt id="arg-threshold-probability">threshold_probability<a class="anchor" aria-label="anchor" href="#arg-threshold-probability"></a></dt>
<dd><p>Probability threshold when computing the GPD
distribution for the surprisals.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments are passed to <code><a href="surprisals.html">surprisals</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The surprisal probabilities may be computed in three different ways.</p><ol><li><p>Given the same <code>distribution</code> that was used to compute the surprisal values.
Under this option, surprisal probabilities are equal to 1 minus the
coverage probability of the largest HDR that contains each value. Surprisal
probabilities smaller than 1e-6 are returned as 1e-6.</p></li>
<li><p>Using a Generalized Pareto Distribution fitted to the most extreme
surprisal values (those with probability less than <code>threshold_probability</code>).
This option is used if <code>GPD = TRUE</code>. For surprisal values with
probability less than <code>threshold_probability</code>, the value of
<code>threshold_probability</code> is returned. Under this option, the distribution is
used for computing the surprisal values but not for determining their
probabilities. Due to extreme value theory, the resulting probabilities should
be relatively insensitive to the distribution used in computing the surprisal
values.</p></li>
<li><p>Empirically as the proportion of observations with greater surprisal values.
This option is used when <code>GPD = FALSE</code> and no distribution is explicitly
provided. This is also insensitive to the distribution used in computing the
surprisal values.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Univariate data</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">49</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  p <span class="op">=</span> <span class="fu">surprisal_prob</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in UseMethod("generate"):</span> no applicable method for 'generate' applied to an object of class "NULL"</span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">n01</span><span class="op">$</span><span class="va">v1</span>,</span></span>
<span class="r-in"><span>  prob1 <span class="op">=</span> <span class="fu">surprisal_prob</span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob2 <span class="op">=</span> <span class="fu">surprisal_prob</span><span class="op">(</span><span class="va">y</span>, GPD <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob3 <span class="op">=</span> <span class="fu">surprisal_prob</span><span class="op">(</span><span class="va">y</span>, <span class="fu">dist_normal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob4 <span class="op">=</span> <span class="fu">surprisal_prob</span><span class="op">(</span><span class="va">y</span>, <span class="fu">dist_normal</span><span class="op">(</span><span class="op">)</span>, GPD <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">prob1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in UseMethod("generate"):</span> no applicable method for 'generate' applied to an object of class "NULL"</span>
<span class="r-in"><span><span class="co"># Bivariate data</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">49</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lookout <span class="op">=</span> <span class="fu"><a href="lookout_prob.html">lookout_prob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 50 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          x       y lookout</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">5</span>  5       0.038<span style="text-decoration: underline;">4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.375</span>  -<span style="color: #BB0000;">0.177</span>   1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  0.853  -<span style="color: #BB0000;">0.859</span>   1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.393</span>   0.471   1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  0.817   0.746   1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">1.24</span>    1.94    0.465 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.464</span>  -<span style="color: #BB0000;">0.019</span><span style="color: #BB0000; text-decoration: underline;">4</span>  1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">1.00</span>   -<span style="color: #BB0000;">0.390</span>   1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.926</span>  -<span style="color: #BB0000;">1.82</span>    1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.025</span><span style="color: #BB0000; text-decoration: underline;">3</span>  0.247   1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
<span class="r-in"><span><span class="co"># Using a regression model</span></span></span>
<span class="r-in"><span><span class="va">of</span> <span class="op">&lt;-</span> <span class="va">oldfaithful</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">duration</span> <span class="op">&lt;</span> <span class="fl">7200</span>, <span class="va">waiting</span> <span class="op">&lt;</span> <span class="fl">7200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_of</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">waiting</span> <span class="op">~</span> <span class="va">duration</span>, data <span class="op">=</span> <span class="va">of</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">of</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">mutate</span><span class="op">(</span>p <span class="op">=</span> <span class="fu">surprisal_prob</span><span class="op">(</span><span class="va">fit_of</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(of, p = surprisal_prob(fit_of)):</span> <span style="color: #00BBBB;">ℹ</span> In argument: `p = surprisal_prob(fit_of)`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error in `UseMethod()`:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> no applicable method for 'generate' applied to an object of class "NULL"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rob Hyndman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

