<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Surprisals — surprisals • weird</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Surprisals — surprisals"><meta name="description" content='Compute surprisals or surprisal probabilities from a model or a
data set. A surprisal is given by \(s = -\log f(y)\) where \(f\) is the
density or probability mass function of the estimated or assumed distribution,
and \(y\) is an observation. A surprisal probability is the probability of
a surprisal at least as extreme as \(s\).
The surprisal probabilities may be computed in three different ways.
Given the same distribution that was used to compute the surprisal values.
Under this option, surprisal probabilities are equal to 1 minus the
coverage probability of the largest HDR that contains each value. Surprisal
probabilities smaller than 1e-6 are returned as 1e-6.
Using a Generalized Pareto Distribution fitted to the most extreme
surprisal values (those with probability less than threshold_probability).
This option is used if approximation = "gpd". For surprisal probabilities
greater than threshold_probability, the value of
threshold_probability is returned. Under this option, the distribution is
used for computing the surprisal values but not for determining their
probabilities. Due to extreme value theory, the resulting probabilities should
be relatively insensitive to the distribution used in computing the surprisal
values.
Empirically as the proportion of observations with greater surprisal values.
This option is used when approxiation = "empirical". This is also
insensitive to the distribution used in computing the surprisal values.

'><meta property="og:description" content='Compute surprisals or surprisal probabilities from a model or a
data set. A surprisal is given by \(s = -\log f(y)\) where \(f\) is the
density or probability mass function of the estimated or assumed distribution,
and \(y\) is an observation. A surprisal probability is the probability of
a surprisal at least as extreme as \(s\).
The surprisal probabilities may be computed in three different ways.
Given the same distribution that was used to compute the surprisal values.
Under this option, surprisal probabilities are equal to 1 minus the
coverage probability of the largest HDR that contains each value. Surprisal
probabilities smaller than 1e-6 are returned as 1e-6.
Using a Generalized Pareto Distribution fitted to the most extreme
surprisal values (those with probability less than threshold_probability).
This option is used if approximation = "gpd". For surprisal probabilities
greater than threshold_probability, the value of
threshold_probability is returned. Under this option, the distribution is
used for computing the surprisal values but not for determining their
probabilities. Due to extreme value theory, the resulting probabilities should
be relatively insensitive to the distribution used in computing the surprisal
values.
Empirically as the proportion of observations with greater surprisal values.
This option is used when approxiation = "empirical". This is also
insensitive to the distribution used in computing the surprisal values.

'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">weird</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/robjhyndman/weird-package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Surprisals</h1>
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/weird-package/blob/main/R/surprisals.R" class="external-link"><code>R/surprisals.R</code></a></small>
      <div class="d-none name"><code>surprisals.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute surprisals or surprisal probabilities from a model or a
data set. A surprisal is given by \(s = -\log f(y)\) where \(f\) is the
density or probability mass function of the estimated or assumed distribution,
and \(y\) is an observation. A surprisal probability is the probability of
a surprisal at least as extreme as \(s\).</p>
<p>The surprisal probabilities may be computed in three different ways.</p><ol><li><p>Given the same distribution that was used to compute the surprisal values.
Under this option, surprisal probabilities are equal to 1 minus the
coverage probability of the largest HDR that contains each value. Surprisal
probabilities smaller than 1e-6 are returned as 1e-6.</p></li>
<li><p>Using a Generalized Pareto Distribution fitted to the most extreme
surprisal values (those with probability less than <code>threshold_probability</code>).
This option is used if <code>approximation = "gpd"</code>. For surprisal probabilities
greater than <code>threshold_probability</code>, the value of
<code>threshold_probability</code> is returned. Under this option, the distribution is
used for computing the surprisal values but not for determining their
probabilities. Due to extreme value theory, the resulting probabilities should
be relatively insensitive to the distribution used in computing the surprisal
values.</p></li>
<li><p>Empirically as the proportion of observations with greater surprisal values.
This option is used when <code>approxiation = "empirical"</code>. This is also
insensitive to the distribution used in computing the surprisal values.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">surprisals</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  probability <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  approximation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"gpd"</span>, <span class="st">"empirical"</span><span class="op">)</span>,</span>
<span>  threshold_probability <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">surprisals</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  probability <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  approximation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"gpd"</span>, <span class="st">"empirical"</span><span class="op">)</span>,</span>
<span>  threshold_probability <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  distribution <span class="op">=</span> <span class="fu"><a href="dist_kde.html">dist_kde</a></span><span class="op">(</span><span class="va">object</span>, multiplier <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>  loo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A model or numerical data set</p></dd>


<dt id="arg-probability">probability<a class="anchor" aria-label="anchor" href="#arg-probability"></a></dt>
<dd><p>Should surprisal probabilities be computed, or the
surprisal values?</p></dd>


<dt id="arg-approximation">approximation<a class="anchor" aria-label="anchor" href="#arg-approximation"></a></dt>
<dd><p>Character string specifying the approximation to use in
computing the surprisal probabilities. Ignored if <code>probability = FALSE</code>. :
<code>none</code> specifies that no approximation is to be used;
<code>gpd</code> specifies that  the Generalized Pareto distribution should be used;
while <code>empirical</code> specifies that the probabilities should be estimated empirically.</p></dd>


<dt id="arg-threshold-probability">threshold_probability<a class="anchor" aria-label="anchor" href="#arg-threshold-probability"></a></dt>
<dd><p>Probability threshold when computing the GPD
approximation. This is the probability below which the GPD is fitted. Only
used if <code>approximation = "gpd"</code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments are passed to the appropriate method.</p></dd>


<dt id="arg-distribution">distribution<a class="anchor" aria-label="anchor" href="#arg-distribution"></a></dt>
<dd><p>A distribution object. If not provided, a kernel density
estimate is computed from the data <code>object</code>.</p></dd>


<dt id="arg-loo">loo<a class="anchor" aria-label="anchor" href="#arg-loo"></a></dt>
<dd><p>Should leave-one-out surprisals be computed?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numerical vector containing the surprisals or surprisal probabilities.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If no distribution is provided, a kernel density estimate is
computed. The leave-one-out surprisals (or LOO surprisals) are obtained by
estimating the kernel density estimate using all other observations.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="dist_kde.html">dist_kde</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rob J Hyndman</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># surprisals computed from bivariate data set</span></span></span>
<span class="r-in"><span><span class="va">oldfaithful</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">duration</span> <span class="op">&lt;</span> <span class="fl">7000</span>, <span class="va">waiting</span> <span class="op">&lt;</span> <span class="fl">7000</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">mutate</span><span class="op">(</span></span></span>
<span class="r-in"><span>    loo_fscores <span class="op">=</span> <span class="fu">surprisals</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">duration</span>, <span class="va">waiting</span><span class="op">)</span>, loo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,189 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time                duration waiting loo_fscores</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 2015-01-02 <span style="color: #949494;">14:53:00</span>      271    <span style="text-decoration: underline;">5</span>040      0.091<span style="text-decoration: underline;">8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 2015-01-09 <span style="color: #949494;">23:55:00</span>      247    <span style="text-decoration: underline;">6</span>060      0.718 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 2015-02-07 <span style="color: #949494;">00:49:00</span>      203    <span style="text-decoration: underline;">5</span>460      0.194 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 2015-02-14 <span style="color: #949494;">01:09:00</span>      195    <span style="text-decoration: underline;">5</span>221      0.157 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 2015-02-21 <span style="color: #949494;">01:12:00</span>      210    <span style="text-decoration: underline;">5</span>401      0.283 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 2015-02-28 <span style="color: #949494;">01:11:00</span>      185    <span style="text-decoration: underline;">5</span>520      0.220 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 2015-03-07 <span style="color: #949494;">00:50:00</span>      160    <span style="text-decoration: underline;">5</span>281      0.249 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 2015-03-13 <span style="color: #949494;">21:57:00</span>      226    <span style="text-decoration: underline;">6</span>000      0.395 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 2015-03-13 <span style="color: #949494;">23:37:00</span>      190    <span style="text-decoration: underline;">5</span>341      0.139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 2015-03-20 <span style="color: #949494;">22:26:00</span>      102    <span style="text-decoration: underline;">3</span>961      0.095<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,179 more rows</span></span>
<span class="r-in"><span><span class="co"># Univariate data</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">49</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  p_kde <span class="op">=</span> <span class="fu">surprisals</span><span class="op">(</span><span class="va">y</span>, loo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  p_normal <span class="op">=</span> <span class="fu">surprisals</span><span class="op">(</span><span class="va">y</span>, distribution <span class="op">=</span> <span class="fu">dist_normal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  p_zscore <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 50 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         y    p_kde    p_normal    p_zscore</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  5     0.000<span style="text-decoration: underline;">292</span> 0.000<span style="text-decoration: underline;">000</span>573 0.000<span style="text-decoration: underline;">000</span>573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.695</span> 0.567    0.487       0.487      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  0.540 0.706    0.590       0.590      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.944</span> 0.448    0.345       0.345      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  1.40  0.330    0.162       0.162      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.982</span> 0.431    0.326       0.326      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  1.32  0.359    0.188       0.188      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.231</span> 0.804    0.817       0.817      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.824</span> 0.504    0.410       0.410      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.480</span> 0.677    0.631       0.631      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">n01</span><span class="op">$</span><span class="va">v1</span>,</span></span>
<span class="r-in"><span>  prob1 <span class="op">=</span> <span class="fu">surprisals</span><span class="op">(</span><span class="va">y</span>, loo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob2 <span class="op">=</span> <span class="fu">surprisals</span><span class="op">(</span><span class="va">y</span>, approximation <span class="op">=</span> <span class="st">"gpd"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob3 <span class="op">=</span> <span class="fu">surprisals</span><span class="op">(</span><span class="va">y</span>, distribution <span class="op">=</span> <span class="fu">dist_normal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob4 <span class="op">=</span> <span class="fu">surprisals</span><span class="op">(</span><span class="va">y</span>, distribution <span class="op">=</span> <span class="fu">dist_normal</span><span class="op">(</span><span class="op">)</span>, approximation <span class="op">=</span> <span class="st">"gpd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">prob1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        y    prob1    prob2    prob3    prob4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  3.81 0.000<span style="text-decoration: underline;">675</span> 0.000<span style="text-decoration: underline;">113</span> 0.000<span style="text-decoration: underline;">139</span> 0.000<span style="text-decoration: underline;">135</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  3.06 0.006<span style="text-decoration: underline;">94</span>  0.001<span style="text-decoration: underline;">94</span>  0.002<span style="text-decoration: underline;">25</span>  0.002<span style="text-decoration: underline;">61</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">3.01</span> 0.010<span style="text-decoration: underline;">9</span>   0.003<span style="text-decoration: underline;">62</span>  0.002<span style="text-decoration: underline;">63</span>  0.003<span style="text-decoration: underline;">08</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">3.00</span> 0.011<span style="text-decoration: underline;">2</span>   0.003<span style="text-decoration: underline;">76</span>  0.002<span style="text-decoration: underline;">73</span>  0.003<span style="text-decoration: underline;">20</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">2.94</span> 0.012<span style="text-decoration: underline;">9</span>   0.004<span style="text-decoration: underline;">56</span>  0.003<span style="text-decoration: underline;">28</span>  0.003<span style="text-decoration: underline;">89</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">2.89</span> 0.014<span style="text-decoration: underline;">6</span>   0.005<span style="text-decoration: underline;">38</span>  0.003<span style="text-decoration: underline;">87</span>  0.004<span style="text-decoration: underline;">61</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  2.68 0.019<span style="text-decoration: underline;">9</span>   0.008<span style="text-decoration: underline;">10</span>  0.007<span style="text-decoration: underline;">46</span>  0.009<span style="text-decoration: underline;">13</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  2.65 0.021<span style="text-decoration: underline;">4</span>   0.008<span style="text-decoration: underline;">87</span>  0.008<span style="text-decoration: underline;">07</span>  0.009<span style="text-decoration: underline;">91</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">2.60</span> 0.028<span style="text-decoration: underline;">3</span>   0.012<span style="text-decoration: underline;">8</span>   0.009<span style="text-decoration: underline;">43</span>  0.011<span style="text-decoration: underline;">6</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">2.59</span> 0.028<span style="text-decoration: underline;">5</span>   0.013<span style="text-decoration: underline;">0</span>   0.009<span style="text-decoration: underline;">53</span>  0.011<span style="text-decoration: underline;">8</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 990 more rows</span></span>
<span class="r-in"><span><span class="co"># Bivariate data</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">49</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob <span class="op">=</span> <span class="fu">surprisals</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lookout <span class="op">=</span> <span class="fu"><a href="lookout_prob.html">lookout_prob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 50 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          x      y  prob lookout</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  0.460   5      0.02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.925</span>  -<span style="color: #BB0000;">0.819</span>  0.4        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  0.181   0.189  0.9        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  0.777   0.204  0.84       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.522</span>  -<span style="color: #BB0000;">0.367</span>  0.62       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.191</span>  -<span style="color: #BB0000;">0.985</span>  0.56       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  0.535   0.293  0.88       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.292</span>  -<span style="color: #BB0000;">0.369</span>  0.78       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  0.099<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.714</span>  0.7        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  1.60    0.107  0.42       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rob Hyndman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

